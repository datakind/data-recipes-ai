{
    "title": "recipes_creation_recipe_db",
    "content": "\n  ## This is a skill to save python code and answers to a question (referred to as 'data recipes') to the recipe database for later use.\nimport os\nimport psycopg2\nimport json\nimport uuid\n\n\n\n\ndef get_recipe_db_connection():\n    \"\"\"\n    This function gets a connection to the database\n    \"\"\"\n    host = os.getenv(\"POSTGRES_RECIPE_HOST\")\n    port = os.getenv(\"POSTGRES_RECIPE_PORT\")\n    database = os.getenv(\"POSTGRES_RECIPE_DB\")\n    user = os.getenv(\"POSTGRES_RECIPE_USER\")\n    password = os.getenv(\"POSTGRES_RECIPE_PASSWORD\")\n\n    conn = psycopg2.connect(\n        dbname=database,\n        user=user,\n        password=password,\n        host=host,\n        port=port\n    )\n    return conn\n\n\n\n\ndef form_recipe_record():\n    #load the data_recipe.json file\n    with open('data_recipe.json') as json_file:\n        cmetadata = json.load(json_file)\n    #form the recipe record\n    recipe_record = { \n        \"uuid\": str(uuid.uuid4()),\n        \"document\": cmetadata['intent'],\n        \"custom_id\": str(uuid.uuid4()),\n        \"cmetadata\": cmetadata,\n        \"approval_status\": \"pending\"\n    }\n    return recipe_record\n\n\n\n\ndef insert_recipe_record(recipe_record):\n    \"\"\"\n    This function inserts a recipe record into the database\n    \"\"\"\n    conn = get_recipe_db_connection()\n    cur = conn.cursor()\n    cur.execute(\n        \"\"\"\n        INSERT INTO langchain_pg_embedding (uuid, document, custom_id, cmetadata, approval_status)\n        VALUES (%s, %s, %s, %s, %s)\n        \"\"\",\n        (\n            recipe_record[\"uuid\"],\n            recipe_record[\"document\"],\n            recipe_record[\"custom_id\"],\n            json.dumps(recipe_record[\"cmetadata\"]),\n            recipe_record[\"approval_status\"]\n        )\n    )\n    conn.commit()\n    conn.close()",
    "file_name": null,
    "description": null,
    "timestamp": "2024-05-12T14:21:38.809485",
    "user_id": "default"
}